<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hansel & Gretel: Video Analysis</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@400;700&family=EB+Garamond:ital,wght@0,400;0,700;1,400&family=Nosifer&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'EB Garamond', serif; }
        .font-nosifer { font-family: 'Nosifer', cursive; }
        .font-cinzel { font-family: 'Cinzel Decorative', cursive; }

        /* Transitions */
        .fade-enter { opacity: 0; transform: scale(0.95); }
        .fade-enter-active { opacity: 1; transform: scale(1); transition: opacity 0.5s ease-out, transform 0.5s ease-out; }
        
        /* Embers Animation */
        @keyframes floatUp {
            0% { transform: translateY(110vh) translateX(0); opacity: 0; }
            10% { opacity: 1; }
            100% { transform: translateY(-10vh) translateX(var(--drift)); opacity: 0; }
        }
        .ember {
            position: absolute;
            border-radius: 50%;
            background: #f97316;
            filter: blur(1px);
            box-shadow: 0 0 10px 2px rgba(255, 69, 0, 0.8);
            animation-name: floatUp;
            animation-timing-function: linear;
            animation-iteration-count: infinite;
        }

        /* Ending Text Pulse/Glitch */
        @keyframes textGlitch {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.9; transform: scale(1.02); }
        }
        .animate-text-glitch { animation: textGlitch 3s infinite ease-in-out; }

        @keyframes bleed {
            0%, 100% { opacity: 0.3; transform: translateY(0); }
            50% { opacity: 0.6; transform: translateY(5px); }
        }
        .animate-bleed { animation: bleed 4s infinite ease-in-out; }

        @keyframes pulse-red {
            0%, 100% { opacity: 0.2; transform: translate(-50%, -50%) scale(1); }
            50% { opacity: 0.6; transform: translate(-50%, -50%) scale(1.1); }
        }
        .animate-pulse-red { animation: pulse-red 4s infinite ease-in-out; }
        
        /* Mobile optimization */
        @media (max-width: 640px) {
            body {
                overflow-y: auto;
                height: auto;
                min-height: 100vh;
            }
            #slide-container {
                padding: 1rem 0;
            }
        }
        
        /* Ensure text is readable on small screens */
        @media (max-width: 480px) {
            .font-nosifer {
                line-height: 1.1;
            }
        }
    </style>
</head>
<body class="bg-black text-stone-200 overflow-hidden h-screen w-screen relative selection:bg-red-900 selection:text-white">

    <!-- 1. Background Image -->
    <div id="bg-layer" class="absolute inset-0 z-0 bg-cover bg-center transition-all duration-1000 ease-in-out opacity-40 grayscale-[30%] contrast-125 scale-105"></div>

    <!-- 2. Overlay Texture (Parchment) -->
    <div class="absolute inset-0 z-0 opacity-20 mix-blend-overlay pointer-events-none bg-cover" style="background-image: url('https://images.unsplash.com/photo-1706271952285-01b5e3fc2d78?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&q=80&w=1080')"></div>

    <!-- 3. Vignette -->
    <div class="absolute inset-0 z-10 bg-gradient-to-b from-black/80 via-transparent to-black/90 pointer-events-none"></div>
    <div class="absolute inset-0 z-10 bg-[radial-gradient(circle_at_center,transparent_0%,rgba(0,0,0,0.8)_100%)] pointer-events-none"></div>

    <!-- 4. Embers (Ending Only) -->
    <div id="embers-container" class="absolute inset-0 z-0 overflow-hidden pointer-events-none"></div>

    <!-- 5. Audio Elements -->
    <audio id="ambient-audio" loop>
        <!-- Creepy music box horror lullaby -->
        <source src="lilliben-creeping-music-box-horror-lullaby-365186.mp3" type="audio/mpeg">
    </audio>
    
    <audio id="heartbeat-audio" loop>
        <!-- Low thrumming heartbeat sound -->
        <source src="https://cdn.pixabay.com/audio/2022/03/22/audio_f6a737007d.mp3" type="audio/mpeg">
    </audio>

    <!-- 6. Main Content -->
    <main class="relative z-20 h-full flex flex-col items-center justify-between p-6 md:p-12 max-w-6xl mx-auto">
        
        <!-- Slide Container -->
        <div id="slide-container" class="flex-grow flex items-center justify-center w-full transition-opacity duration-300">
            <!-- Content Injected via JS -->
        </div>

        <!-- Controls -->
        <div id="controls-container" class="flex items-center gap-8 mt-12 transition-opacity duration-500">
            <!-- Prev Button -->
            <button id="btn-prev" class="group flex items-center justify-center w-16 h-16 rounded-full border-2 border-stone-600 bg-black/50 backdrop-blur-sm text-stone-400 transition-all duration-300 hover:border-red-800 hover:text-red-500 hover:shadow-[0_0_20px_rgba(185,28,28,0.3)] disabled:opacity-20 disabled:cursor-not-allowed disabled:hover:shadow-none disabled:hover:border-stone-600 disabled:hover:text-stone-400">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"/></svg>
            </button>

            <!-- Progress -->
            <div class="flex flex-col items-center gap-1 font-serif text-stone-500 tracking-widest text-sm">
                <span class="flex items-center gap-2">
                    <svg id="skull-left" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="9" cy="12" r="1"/><circle cx="15" cy="12" r="1"/><path d="M8 20v2h8v-2"/><path d="m12.5 17-.5-1-.5 1h1z"/><path d="M16 20a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20"/></svg>
                    <span id="slide-label">INTRO</span>
                    <svg id="skull-right" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="9" cy="12" r="1"/><circle cx="15" cy="12" r="1"/><path d="M8 20v2h8v-2"/><path d="m12.5 17-.5-1-.5 1h1z"/><path d="M16 20a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20"/></svg>
                </span>
                <div class="h-0.5 w-24 bg-stone-800 rounded-full overflow-hidden">
                    <div id="progress-bar" class="h-full bg-red-900 w-0 transition-all duration-500"></div>
                </div>
            </div>

            <!-- Next Button -->
            <button id="btn-next" class="group flex items-center justify-center w-16 h-16 rounded-full border-2 border-stone-600 bg-black/50 backdrop-blur-sm text-stone-400 transition-all duration-300 hover:border-red-800 hover:text-red-500 hover:shadow-[0_0_20px_rgba(185,28,28,0.3)] disabled:opacity-20 disabled:cursor-not-allowed disabled:hover:shadow-none disabled:hover:border-stone-600 disabled:hover:text-stone-400">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="m9 18 6-6-6-6"/></svg>
            </button>
        </div>
    </main>

    <script>
        // --- DATA ---
        const questions = [
            { 
                id: 1, 
                title: "Moral Pedagogy", 
                text: "How does Hansel and Gretel use horror and violence as a way to teach a moral lesson rather than simply to scare the audience?", 
                answer: "The violence isn't randomâ€”it's a teaching tool. The threat of being eaten is directly connected to the children eating the witch's house first. By linking what they consume to the danger of being consumed, the tale creates a visceral connection between bad behavior and consequences. It teaches moderation through fear in a way that sticks." 
            },
            { 
                id: 2, 
                title: "Social Fears", 
                text: "In what ways can the witch in Hansel and Gretel be interpreted as a reflection of real social fears, such as hunger, poverty, and child abandonment, rather than only as a fantasy monster?", 
                answer: "The witch embodies real anxieties about older women living alone, poverty, and survival during famine. She's historically coded with anti-Semitic stereotypes and the fear of the 'other.' She inverts the nurturing mother figureâ€”instead of feeding children out of love, she fattens them up to eat them. Her gingerbread house is a trap disguised as comfort, reflecting fears about when help might actually be dangerous." 
            },
            { 
                id: 3, 
                title: "Family Dynamics", 
                text: "How does the story of Hansel and Gretel challenge the idealized image of the family that is often presented in modern fairy-tale adaptations, such as Disney films?", 
                answer: "Unlike Disney's sanitized versions, Hansel and Gretel shows that the real horror starts at home. The parents abandon their children to starveâ€”that's the inciting incident, not some external evil. In earlier versions, it was their actual mother, not a stepmother, who suggests this. The story forces us to confront that sometimes the greatest danger comes from within the family, not from monsters in the forest." 
            },
            { 
                id: 4, 
                title: "Genre Connections", 
                text: "How does Hansel and Gretel support the idea that fairy tales and horror are closely connected rather than separate genres?", 
                answer: "This is basically a proto-horror story with all the elements: dark isolated setting, body horror (cannibalism), and Freud's 'Uncanny'â€”making the familiar terrifying. The gingerbread house is a death trap. Gretel becomes violent to survive, like the 'Final Girl' in slasher films. Fairy tales and horror are siblingsâ€”both deal with our deepest fears and use monsters to explore what terrifies us." 
            },
            { 
                id: 5, 
                title: "Gender Horror", 
                text: "How might modern retellings of Hansel and Gretel, especially versions that focus more on Gretel's experience, reflect the idea of gender horror and changing cultural concerns?", 
                answer: "Modern versions shift focus to Gretel's perspective. The witch becomes a symbol of female power that society fears. Contemporary retellings explore how Gretel must transform herself, sometimes violently, to survive. The horror becomes: what does it cost a young woman to claim her power? These adaptations tap into anxieties about female agency and the violent transformations women undergo to survive in a hostile world." 
            }
        ];

        // --- STATE ---
        let currentIndex = 0; // 0=Intro, 1-5=Questions, 6=Ending
        const bgForest = "url('https://images.unsplash.com/photo-1770105328610-e138ba4597cc?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&q=80&w=1080')";
        const bgEnding = "url('https://images.unsplash.com/photo-1677104165819-2e5ab9a0821f?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&q=80&w=1080')";
        let audioInitialized = false;

        // --- DOM ELEMENTS ---
        const container = document.getElementById('slide-container');
        const bgLayer = document.getElementById('bg-layer');
        const embersContainer = document.getElementById('embers-container');
        const btnPrev = document.getElementById('btn-prev');
        const btnNext = document.getElementById('btn-next');
        const slideLabel = document.getElementById('slide-label');
        const progressBar = document.getElementById('progress-bar');
        const skullLeft = document.getElementById('skull-left');
        const skullRight = document.getElementById('skull-right');
        const ambientAudio = document.getElementById('ambient-audio');
        const heartbeatAudio = document.getElementById('heartbeat-audio');

        // --- RENDER FUNCTION ---
        function render() {
            // 1. Update Background
            bgLayer.style.backgroundImage = currentIndex === 6 ? bgEnding : bgForest;

            // 2. Manage Embers
            if (currentIndex === 6) {
                if (embersContainer.childElementCount === 0) startEmbers();
            } else {
                embersContainer.innerHTML = '';
            }

            // 3. Update Audio
            updateAudio();

            // 4. Generate HTML
            let html = '';
            
            if (currentIndex === 0) {
                // INTRO
                html = `
                <div class="text-center fade-enter fade-enter-active px-4">
                    <h1 class="font-nosifer text-4xl sm:text-5xl md:text-8xl text-red-700 drop-shadow-[0_4px_10px_rgba(0,0,0,0.9)] tracking-wider mb-4">HANSEL<br/>&<br/>GRETEL</h1>
                    <div class="h-1 bg-gradient-to-r from-transparent via-red-900 to-transparent w-full max-w-md mx-auto mb-8 transition-all duration-1000" style="width: 100%"></div>
                    <h2 class="font-cinzel text-lg sm:text-xl md:text-3xl text-stone-300 tracking-widest mb-8">Video Analysis Questions (Module 4)</h2>
                    <p class="font-serif text-base sm:text-lg text-stone-500 italic max-w-lg mx-auto mb-4 px-4">"They saw that the little house was built entirely of bread and roofed with cakes..."</p>
                    <p class="font-serif text-stone-600 text-xs sm:text-sm mt-6">ðŸ”Š Click anywhere to enable atmospheric audio</p>
                </div>`;
            } else if (currentIndex === 6) {
                // ENDING
                html = `
                <div class="relative w-full flex flex-col items-center justify-center text-center fade-enter fade-enter-active px-4">
                    <!-- Red Glow Pulse -->
                    <div class="absolute top-1/2 left-1/2 w-[300px] sm:w-[500px] h-[300px] sm:h-[500px] bg-red-900/30 blur-[100px] rounded-full pointer-events-none animate-pulse-red" style="z-index: -1;"></div>

                    <!-- Main Text -->
                    <div class="relative mb-8 sm:mb-12">
                        <h1 class="relative z-10 font-nosifer text-5xl sm:text-7xl md:text-9xl text-transparent bg-clip-text bg-gradient-to-b from-stone-200 to-stone-500 drop-shadow-[0_0_25px_rgba(185,28,28,0.8)] tracking-widest leading-none animate-text-glitch">
                            FINIS
                        </h1>
                        <!-- Bleeding Effect -->
                        <h1 class="absolute inset-0 font-nosifer text-5xl sm:text-7xl md:text-9xl text-red-900/40 blur-sm pointer-events-none tracking-widest leading-none animate-bleed" aria-hidden="true">
                            FINIS
                        </h1>
                    </div>

                    <!-- Quote Box -->
                    <div class="bg-black/40 p-4 sm:p-6 md:p-8 rounded-xl backdrop-blur-sm border border-red-900/20 max-w-2xl mx-auto space-y-4 sm:space-y-6">
                        <p class="font-cinzel text-lg sm:text-xl md:text-3xl text-red-500 tracking-widest uppercase animate-pulse">The End... Or Is It?</p>
                        <div class="h-px w-24 sm:w-32 bg-gradient-to-r from-transparent via-red-900 to-transparent mx-auto"></div>
                        <p class="font-serif text-stone-300 italic text-base sm:text-lg md:text-2xl leading-relaxed">"My tale is done, there runs a mouse; whosoever catches it, may make himself a big fur cap out of it."</p>
                        <div class="flex justify-center gap-3 sm:gap-4 pt-2 sm:pt-4 opacity-50">
                            <div class="w-2 h-2 bg-red-900 rounded-full animate-bounce" style="animation-delay: 0s"></div>
                            <div class="w-2 h-2 bg-red-900 rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
                            <div class="w-2 h-2 bg-red-900 rounded-full animate-bounce" style="animation-delay: 0.4s"></div>
                        </div>
                    </div>
                </div>`;
            } else {
                // QUESTIONS (1-5)
                const q = questions[currentIndex - 1];
                html = `
                <div class="bg-black/60 backdrop-blur-md p-6 md:p-12 border border-stone-800 rounded-lg shadow-2xl relative overflow-hidden w-full max-w-4xl fade-enter fade-enter-active">
                    <!-- Corners -->
                    <div class="absolute top-0 left-0 w-8 h-8 border-t-2 border-l-2 border-red-900/50"></div>
                    <div class="absolute top-0 right-0 w-8 h-8 border-t-2 border-r-2 border-red-900/50"></div>
                    <div class="absolute bottom-0 left-0 w-8 h-8 border-b-2 border-l-2 border-red-900/50"></div>
                    <div class="absolute bottom-0 right-0 w-8 h-8 border-b-2 border-r-2 border-red-900/50"></div>

                    <div class="flex flex-col items-center text-center px-2 sm:px-4">
                        <span class="inline-block text-red-800 font-cinzel text-base sm:text-lg md:text-xl tracking-widest border-b border-red-900/30 pb-2 mb-3 sm:mb-4">Question ${q.id}</span>
                        <h2 class="font-cinzel text-xl sm:text-2xl md:text-4xl text-stone-200 leading-tight mb-4 sm:mb-6">${q.title}</h2>
                        <p class="font-serif text-base sm:text-lg md:text-2xl text-stone-300 leading-relaxed font-medium mb-6 sm:mb-8">${q.text}</p>

                        <!-- Button -->
                        <button onclick="toggleAnswer(this)" class="group flex items-center gap-2 px-4 sm:px-6 py-2 rounded-full border border-stone-700 bg-stone-900/50 text-stone-400 font-serif tracking-widest text-xs sm:text-sm uppercase transition-all duration-300 hover:bg-stone-800 hover:text-white hover:border-stone-500 animate-pulse mb-4 sm:mb-6">
                            <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></svg>
                            <span>Reveal Analysis</span>
                        </button>

                        <!-- Answer Box -->
                        <div class="answer-container hidden w-full overflow-hidden transition-all duration-500">
                            <div class="bg-red-950/20 border-l-2 border-red-900/60 p-4 sm:p-6 rounded-r-lg text-left mt-2">
                                <h3 class="text-red-500 font-cinzel text-xs sm:text-sm mb-2 tracking-widest uppercase">Analysis</h3>
                                <p class="font-serif text-sm sm:text-base md:text-xl text-stone-300 italic leading-relaxed">${q.answer}</p>
                            </div>
                        </div>
                    </div>
                </div>`;
            }

            container.innerHTML = html;
            updateControls();
        }

        // --- CONTROLS LOGIC ---
        function updateControls() {
            btnPrev.disabled = currentIndex === 0;
            btnNext.disabled = currentIndex === 6;

            let label = `${currentIndex} / ${questions.length}`;
            let progress = (currentIndex / questions.length) * 100;
            let skullClass = "";

            if (currentIndex === 0) {
                label = "INTRO";
                progress = 0;
                skullClass = "text-red-700 animate-pulse";
            } else if (currentIndex === 6) {
                label = "FINIS";
                progress = 100;
                skullClass = "text-red-700 animate-pulse";
            }

            slideLabel.innerText = label;
            progressBar.style.width = `${progress}%`;
            
            // Toggle red skulls
            const isRed = currentIndex === 0 || currentIndex === 6;
            skullLeft.setAttribute("class", isRed ? "text-red-700 animate-pulse transition-colors" : "transition-colors");
            skullRight.setAttribute("class", isRed ? "text-red-700 animate-pulse transition-colors" : "transition-colors");
        }

        btnNext.addEventListener('click', () => {
            if (currentIndex < 6) {
                currentIndex++;
                render();
            }
        });

        btnPrev.addEventListener('click', () => {
            if (currentIndex > 0) {
                currentIndex--;
                render();
            }
        });

        // --- REVEAL LOGIC ---
        window.toggleAnswer = function(btn) {
            const container = btn.parentElement.querySelector('.answer-container');
            const isHidden = container.classList.contains('hidden');
            
            if (isHidden) {
                container.classList.remove('hidden');
                btn.classList.remove('animate-pulse');
                btn.classList.add('bg-red-900/20', 'text-red-400', 'border-red-900/50');
                btn.querySelector('span').innerText = "Hide Analysis";
                btn.querySelector('svg').innerHTML = '<path d="M9.88 9.88a3 3 0 1 0 4.24 4.24"/><path d="M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68"/><path d="M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7c.44 0 .87-.03 1.28-.09"/><line x1="2" x2="22" y1="2" y2="22"/>';
            } else {
                container.classList.add('hidden');
                btn.classList.add('animate-pulse');
                btn.classList.remove('bg-red-900/20', 'text-red-400', 'border-red-900/50');
                btn.querySelector('span').innerText = "Reveal Analysis";
                btn.querySelector('svg').innerHTML = '<path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/>';
            }
        };

        // --- EMBERS LOGIC ---
        function startEmbers() {
            for (let i = 0; i < 40; i++) {
                createEmber(i);
            }
        }

        function createEmber(i) {
            const ember = document.createElement('div');
            ember.classList.add('ember');
            
            // Random properties
            const left = Math.random() * 100;
            const size = 4 + Math.random() * 6;
            const duration = 2 + Math.random() * 4;
            const delay = Math.random() * 2;
            const drift = Math.random() > 0.5 ? 50 : -50;

            ember.style.left = `${left}%`;
            ember.style.width = `${size}px`;
            ember.style.height = `${size}px`;
            ember.style.animationDuration = `${duration}s`;
            ember.style.animationDelay = `${delay}s`;
            ember.style.setProperty('--drift', `${drift}px`);

            embersContainer.appendChild(ember);
        }

        // --- AUDIO FUNCTIONS ---
        // Initialize audio system with user interaction
        function initAudio() {
            // Set initial volumes to 0
            ambientAudio.volume = 0;
            heartbeatAudio.volume = 0;
            
            // One-time click listener to start audio (browser autoplay policy)
            const startAudio = () => {
                if (!audioInitialized) {
                    audioInitialized = true;
                    
                    // Start ambient music box with fade in
                    ambientAudio.play().then(() => {
                        fadeInAudio(ambientAudio, 0.25, 2000); // Fade to 25% volume over 2 seconds
                    }).catch(err => {
                        console.log('Audio autoplay prevented:', err);
                    });
                    
                    // Remove the listener after first interaction
                    document.body.removeEventListener('click', startAudio);
                }
            };
            
            // Add listener to body for first click
            document.body.addEventListener('click', startAudio);
        }

        // Fade in audio
        function fadeInAudio(audioElement, targetVolume, duration) {
            const startVolume = audioElement.volume;
            const volumeStep = (targetVolume - startVolume) / (duration / 50);
            
            const fadeInterval = setInterval(() => {
                if (audioElement.volume < targetVolume - 0.01) {
                    audioElement.volume = Math.min(audioElement.volume + volumeStep, targetVolume);
                } else {
                    audioElement.volume = targetVolume;
                    clearInterval(fadeInterval);
                }
            }, 50);
        }

        // Fade out audio
        function fadeOutAudio(audioElement, duration) {
            const startVolume = audioElement.volume;
            const volumeStep = startVolume / (duration / 50);
            
            const fadeInterval = setInterval(() => {
                if (audioElement.volume > 0.01) {
                    audioElement.volume = Math.max(audioElement.volume - volumeStep, 0);
                } else {
                    audioElement.volume = 0;
                    audioElement.pause();
                    clearInterval(fadeInterval);
                }
            }, 50);
        }

        // Control heartbeat audio based on slide
        function updateAudio() {
            if (currentIndex === 6) {
                // Ending slide - play heartbeat
                if (audioInitialized && heartbeatAudio.paused) {
                    heartbeatAudio.play().then(() => {
                        fadeInAudio(heartbeatAudio, 0.35, 1500); // Fade to 35% volume over 1.5 seconds
                    }).catch(err => {
                        console.log('Heartbeat audio error:', err);
                    });
                }
            } else {
                // Other slides - stop heartbeat
                if (!heartbeatAudio.paused) {
                    fadeOutAudio(heartbeatAudio, 1000); // Fade out over 1 second
                }
            }
        }

        // --- INIT ---
        bgLayer.style.backgroundImage = bgForest;
        initAudio();
        render();

    </script>
</body>
</html>
